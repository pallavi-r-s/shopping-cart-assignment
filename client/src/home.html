<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, height=device-height ,initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>SABKA BAZAR</title>
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">

    <link rel="stylesheet" type="text/css" href="./styles/product.css">
</head>
<body>

<header>
    <nav id="main-navbar" class="navbar navbar-default navbar-fixed-top">
        <div class="container navbar-container">
            <div class="navbar-header">
                <!-- <p class="logo"><img src="./static/images/logo.png"></p> -->
                <a class="navbar-brand" href="#"><img src="./static/images/logo.png"></a>
                <div id="navbar" style="margin-top: -98px;margin-left: 200px;display: flex;" class="navbar-collapse collapse">
                    <ul style="list-style:none;" class="nav navbar-nav navbar-left">
                        <li><a href="./home.html">Home</a></li>
                        <li><a href="./product.html">Products</a></li>
                        
                    </ul> 
                    <div style="align-self: center;margin: 20px;">
                            
                            
                        <button class="cart open-button"><img src="./static/images/cart.svg" height="30px" width="26px" alt="cart image"><span>0</span>items</button>
                    </div> 
                </div>
            </div>

            <div class="top-social">
                <ul id="top-social-menu">
                    
                    <li><a href="./login.html">SignIn</a></li>
                    <li><a href="./register.html">Register</a></li>
                </ul>
            </div>
        </div>
    </nav>
</header>

<dialog class="modal">
  <div class="modal-header">
    <div class="Header">
        <h3 class="Heading">Shopping Cart</h3>
        <h5 class="Action">Remove all</h5>
        <i class="material-icons md-18 close-button">close</i>
    </div>
    
    <div class="CartContainer">

        
        <!-- <hr> 
        <div class="checkout">
        <div class="total">
            <div>
                <div class="Subtotal">Sub-Total</div>
                <div class="items">2 items</div>
            </div>
            <div class="total-amount">$6.18</div>
        </div>
        <button class="button">Checkout</button>
        </div> -->
    </div>
  </div>
</dialog> 
  
<main id="main" style="display:inline-flex;margin-left: 16%; padding-top: 0px;">
    
    <div class="slidercontainer">
        <button id="left">PREV</button>
        <button id="right">NEXT</button>
        
        <div class="carousel">
          <img src="./static/images/offers/offer1.jpg" alt="1">
          <img src="./static/images/offers/offer2.jpg" alt="2">
          <img src="./static/images/offers/offer3.jpg" alt="3">
          <img src="./static/images/offers/offer4.jpg" alt="4">
          <img src="./static/images/offers/offer5.jpg" alt="5">
          
        </div>

    </div>
    <section id="section1" style="display:inline-flex">
     <div id="carddiv">

     </div>
    </section>

   
    
</main>
<Footer id="footer">
    <div><p> Copyright 2011-2018 Subka Bazaar Grocery Supplies Pvt Ltd </p> </div>
</Footer>


<script>

        window.onscroll = function() {fixedHeader()};

        var header = document.getElementById("main-navbar");
        var sticky = header.offsetTop;

        function fixedHeader() {
        if (window.pageYOffset > sticky) {
            header.classList.add("sticky");
        } else {
            header.classList.remove("sticky");
        }
        }
        
        const right = document.getElementById('right');
        const left = document.getElementById('left');
        const carousel = document.querySelector('.carousel');

        const modal= document.querySelector('.modal');
        const openModal= document.querySelector('.open-button');
        const closeModal= document.querySelector('.close-button');

        openModal.addEventListener('click', () => {
        modal.showModal();
        });

        closeModal.addEventListener('click', () => {
        modal.close();
        });
        
        fetch('http://localhost:5000/categories')
            .then(function (response) {
                //console.log(response.json());
                return response.json();
            })
            .then(function (data) {
                appendData(data);
            })
            .catch(function (err) {
                console.log('error: ' + err);
            });
        function appendData(data){

            console.log(data);

            var carddiv = document.getElementById("carddiv");

            data.forEach((result, idx) => {

            // Construct card content
            var content = `
                <div class="card">

                    <div class="photo">
                    <img src=".${result.imageUrl}">
                    </div>
                    <div class="description">
                    <h2>${result.name}</h2>
                    <br>
                    

                    <p>${result.description}</p>
                    <br>
                    <button>Explore ${result.key}</button>
                    
                    </div>
                    </div>
            `;

            // Append newyly created card element to the container
            carddiv.innerHTML += content;
            })
        }


        let counter = 650;
        right.addEventListener('click',()=>{
            if(counter === 1950){
                counter = 0;
            }
            carousel.style.transform = `translateX(-${counter}px)`;
            counter = counter + 650;
        });

        var counterBack;
        left.addEventListener('click', ()=>{
            if(counter === 650){
                counterBack = -1300;
                counter = 1950;
            }
            else if(counter === 1300){
                counterBack = 0;
                counter = 650;
            }else if(counter === 1950){
                counterBack = -650;
                counter = 1300;
            }
            carousel.style.transform = `translateX(${counterBack}px)`;
        });

        function displayCart(){
            let cartItems = localStorage.getItem("productsInCart");
            cartItems = JSON.parse(cartItems);

            let cartContainer = document.querySelector("CartContainer");

            console.log("cart items: ",cartItems);

            if( cartItems && cartContainer){
                cartContainer.innerHTML = '';

                Object.values(cartItems).map(item =>{

                    console.log("in dispaly fun ",item.name);

                    cartContainer.innerHTML += `
                    <div class="Cart-Items">
                        <div class="image-box">
                            <img src=".${item.imageURL}" style="height:20px"/>
                        </div>
                        <div class="about">
                            <h1 class="title">${item.name}</h1><br>
                            <h3 class="subtitle">${item.description}</h3>
                            
                        </div>
                        <div class="counter">
                            <div class="btn">+</div>
                            <div class="count">${item.inCart}</div>
                            <div class="btn">-</div>
                        </div>
                        <div class="prices">
                            <div class="amount">${item.price}</div>
                            <div class="save"><u>Save for later</u></div>
                            <div class="remove"><u>Remove</u></div>
                            
                        </div>
                    </div>
                    `
                });
            }

        }
        displayCart();
</script>
</body>
</html>

